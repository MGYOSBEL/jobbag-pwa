<div class="container container-ep-component bg-faded py-4">
  <div class="row justify-content-center" id="edit-profile-container2">
    <div class="col-8 container-col">
      <form [formGroup]="editProfileForm">
        <div class="accordion" id="accordionExample">
          <div class="card tittle-profile-card" style="border-radius: 0;">
            <div class="card-header" id="headingMain">
              <div class="row">
                <div class="col-10">
                  <label style="color: white;">
                    Edit Profile
                  </label>
                </div>
                <div class="col-2 btn-collapse-col">
                  <button type="button" class="close" aria-label="Close" style="color: white;" data-toggle="modal"
                    data-target="#closeModal">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
              </div>
            </div>
          </div>
          <div class="container container-ep-form">
            <div class="container scroll-host">
              <div class="card" id="section-card">
                <div class="card-header card-header-collapse" id="headingOne" data-toggle="collapse"
                  data-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                  <div class="row">
                    <div class="col-9">
                      <p class="text-left">General Information</p>
                    </div>
                    <div class="col-3 text-right">
                      <i class="fa fa-angle-down" aria-hidden="true"></i>
                      <!-- <i class="fa fa-angle-up" aria-hidden="true"></i>                       -->
                    </div>
                  </div>
                </div>
                <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordionExample">
                  <div class="card-body">
                    <div class="form-group row mx-auto" style="margin-top: 2rem;">
                      <div class="col-6">
                        <label class="form-text" for="username">
                          Username:
                        </label>
                        <input type="text" class="form-control rounded-0" id="username" formControlName="username">
                      </div>
                      <div class="col-6">
                        <div class="form-group">
                          <label class="form-text" for="email">
                            Email:
                          </label>
                          <input type="email" class="form-control rounded-0" id="email" formControlName="email">
                        </div>
                      </div>
                    </div>
                    <div class="form-group row mx-auto">
                      <div class="col-12">
                      <label class="stepper-text">Name</label>
                      <input type="text" class="form-control" formControlName="accountName" id="accountName"
                        [ngClass]="editProfileForm.get('accountName').invalid && (editProfileForm.get('accountName').dirty ||
                        editProfileForm.get('accountName').touched) ? 'is-invalid' : '' " placeholder="Name">
                    </div>
                    </div>
                    <div class="row container-radio-btn px-3" style="margin-bottom: 3rem;">
                      <div class="col-12">
                          <label class="stepper-text">Select your Account Type</label>
                      </div>
                      <div class="col-4 text-center px-0" style="margin-left: 3rem;">
                        <div class="form-group row">
                          <input type="radio" class="form-check-input" name="accountType" formControlName="accountType" value="PERSONAL">
                          <label for="accountName" class="form-check-label">Personal</label>
                        </div>
                      </div>
                      <div class="col-4 text-center px-0" style="margin-left: 3rem;">
                        <div class="form-group row" >
                          <input type="radio" class="form-check-input" name="accountType" formControlName="accountType" value="COMPANY">
                          <label for="exampleInputEmail1" class="form-check-label">Company</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="card" id="section-card">
                <div class="card-header card-header-collapse" id="headingTwo" data-toggle="collapse"
                  data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                  <div class="row">
                    <div class="col-9">
                      <p class="text-left">Picture</p>
                    </div>
                    <div class="col-3 text-right">
                      <i class="fa fa-angle-down" style="font-size:1.5rem;color:#2888C7"></i>
                    </div>
                  </div>
                </div>
                <div id="collapseTwo" class="collapse" aria-labelledby="collapseTwo" data-parent="#accordionExample">
                  <div class="card-body">
                    <div class="form-group">
                      <div class="row">
                        <div class="col-12" style="text-align: center;">
                          <label for="pictureInput" class="">
                            <input class="" id="pictureInput" type="file" formControlName="profilePicture"
                              (change)="uploadPicture($event)" accept="image/*" />
                            <div class="m-0 p-0" *ngIf="defaultPicture; else profileHasPicture">
                              <span style="font-size: 120px; color: #2888C7" class="icon-user-image"></span>
                              <button type="button" class="btn btn-circle btn-add-img"
                                style="position: absolute; right: 16rem; top:7.7rem; background-color: #2985c4; color: white;
                                pointer-events: none; cursor: pointer;">
                                <i class="fa fa-plus"></i>
                              </button>
                            </div>
                            <ng-template #profileHasPicture>
                              <img [src]="previewUrl" class="rounded-circle svg-add-user mx-auto d-block" alt="Profile Picture">
                              <button type="button" class="btn btn-circle btn-add-img"
                                style="position: absolute; right: 16rem; top:7.7rem; background-color: #2985c4; color: white;
                                pointer-events: none; cursor: pointer;">
                                <i class="fa fa-plus"></i>
                              </button>
                            </ng-template>
                          </label>
                          <button *ngIf="!defaultPicture" type="button" class="btn btn-danger btn-circle btn-del-img"
                            style="position: absolute; left: 20.5em; top: 3rem;" (click)="delSelectedPicture()">
                            <i class="fa fa-times"></i>
                          </button>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-12" style="text-align: center;">
                          <h6 class="text-center" style="color: #6c757d;">Upload a picture or select an Avatar</h6>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-3 mx-auto">
                          <img src="assets/img/worker.png" class="avatar-img" alt="Responsive image"
                            (click)="uploadAvatar($event)">
                        </div>
                        <div class="col-3 mx-auto">
                          <img src="assets/img/officer.png" class="avatar-img" alt="Responsive image"
                            (click)="uploadAvatar($event)">
                        </div>
                        <div class="col-3 mx-auto">
                          <img src="assets/img/worker-2.png" class="avatar-img" alt="Responsive image"
                            (click)="uploadAvatar($event)">
                        </div>
                        <div class="col-3 mx-auto">
                          <img src="assets/img/lawyer.png" class="avatar-img" alt="Responsive image"
                            (click)="uploadAvatar($event)">
                        </div>
                      </div>
                    </div>

                  </div>
                </div>
              </div>
              <ng-template [ngIf]="role === 'SERVICE_PROVIDER'">
                <div class="card" id="section-card">
                <div class="card-header card-header-collapse" id="headingThree" data-toggle="collapse"
                  data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                  <div class="row">
                    <div class="col-9">
                      <p class="text-left">Countries</p>
                    </div>
                    <div class="col-3 text-right">
                      <i class="fa fa-angle-down" style="font-size:1.5rem;color:#2888C7"></i>
                    </div>
                  </div>
                </div>
                <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordionExample">
                  <div class="card-body">
                    <div class="row">
                      <div class="col-12 py-5">
                        <app-multi-select [selectedDivisions]="activeProfile.divisions"
                          (selected)="onDivisionsSelect($event)">
                        </app-multi-select>
                      </div>
                    </div>
                  </div>
                </div>
                </div>
                <div class="card" id="section-card">
                <div class="card-header card-header-collapse" id="headingFour" data-toggle="collapse"
                  data-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                  <div class="row">
                    <div class="col-9">
                      <p class="text-left">Services</p>
                    </div>
                    <div class="col-3 text-right">
                      <i class="fa fa-angle-down" style="font-size:1.5rem;color:#2888C7"></i>
                    </div>
                  </div>
                </div>
                <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#accordionExample">
                  <div class="card-body">
                    <div class="row">
                      <div class="col-12 py-5">
                        <div class="row justify-content-between">
                          <div class="col">My Services</div>
                          <div *ngIf="editProfileForm.get('selectedServices').value.length > 0" class="col text-right" >
                            <button class="btn btn-link" style="color:rgb(148,42,44);" (click)="clearServices()"
                            data-toggle="tooltip" data-placement="top" title="Unselect all">
                              <span class="fas fa-times" ></span>
                            </button>
                          </div>
                        </div>
                        <ng-select
                          formControlName="selectedServices"
                          [items]="services"
                          [multiple]="true"
                          [closeOnSelect]="false"
                          [hideSelected]="true"
                          bindLabel="descriptionEs"
                          bindLabel="descriptionEs"
                          bindValue="id"
                          [searchFn]="customSearchFn"
                          >
                          <ng-template ng-option-tmp let-item="item">
                              {{item.descriptionEs}}
                          </ng-template>
                      </ng-select>
                      </div>
                    </div>
                  </div>
                </div>
                </div>
                <div class="card" id="section-card">
                <div class="card-header card-header-collapse" id="headingFive" data-toggle="collapse"
                  data-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
                  <div class="row">
                    <div class="col-9">
                      <p class="text-left">Curriculum Vitae</p>
                    </div>
                    <div class="col-3 text-right">
                      <i class="fa fa-angle-down" style="font-size:1.5rem;color:#2888C7"></i>
                    </div>
                  </div>
                </div>
                <div id="collapseFive" class="collapse" aria-labelledby="headingFive" data-parent="#accordionExample">
                  <div class="card-body pt-0">
                    <div class="row">
                      <div class="col-12 py-3">
                        <div class="row justify-content-center" style="margin-top: 1.5rem;margin-bottom: 1.5rem;">
                          <div class="col-12">
                            <p style="color:#bebcbe;font-size:0.85rem">Upload your Updated CV, only in PDF format!</p>
                          </div>
                          <div class="col-2">
                          </div>
                          <div class="col-4 pr-0">
                            <label *ngIf="!(cvChange === 'LOADED')" for="curriculumLabel" id="curriculumLabel">
                              <p *ngIf="!(cvChange === 'LOADED')">Upload File</p>
                            </label>
                            <label *ngIf="(cvChange === 'LOADED')" for="curriculumLabel" id="curriculumLabelSuccess">
                              <p *ngIf="(cvChange === 'LOADED')">File Upload Succes</p>
                            </label>
                          </div>
                          <div class="col-3 pl-0">
                            <label for="curriculumUpload" id="curriculumUpload">
                              <div class="upload-btn-wrapper">
                                <button class="btn-uploadcv"><i class="far fa-folder fa-2x"></i></button>
                                <input type="file" name="myfile" accept="pdf/*" formControlName="curriculum"
                                       class="form-control-file" id="file-upload" (change)="uploadCV($event)" />
                              </div>
                            </label>
                          </div>
                          <div *ngIf="(cvChange === 'LOADED')" class="card col-4 my-0" style="border:transparent; margin-bottom: 1.5rem;">
                            <div class="row" style="background-color: #2982c1;margin-left: 0;margin-right: 0;">
                              <div class="col-12 text-center my-0" style="background-color: #2982c1;">
                                <i class="fa fa-file-pdf fa-2x my-2" style="color: #fff;"></i>
                                <hr style="border: 0.5px solid white;margin-bottom: 0; margin-top: 0;">
                              </div>
                            </div>
                            <div class="row" style="background-color: #2982c1;margin-left: 0;margin-right: 0; padding-bottom: 0.2rem;">
                              <div class="col-6 text-center mt-0" style="padding:0">
                                <button class="btn btn-link"  (click)="viewCV()">
                                  <i class="fas fa-eye" style="color: #fff;font-size: 0.75rem;"></i>
                                </button>
                              </div>
                              <div class="col-6 text-center mt-0" style="padding:0">
                                <button class="btn btn-link" data-toggle="modal" data-target="#deleteCVModal"
                                        (click)="deleteCV()">
                                  <i class="fas fa-trash-alt" style="color: #fff;font-size: 0.75rem;"></i>
                                </button>
                              </div>
                            </div>
                            <div class="card-footer" style="padding:0; background-color: white;">
                              <div class="row" style="margin: 0;">
                                <div class="col-12 text-left" style="padding:0">
                                  <style>
                                    .ellipsis {
                                      text-overflow: ellipsis;
                                    }
                                  </style>
                                  <p class="overflow ellipsis" id="file-upload-filename"
                                        style="font-weight: bold;font-size: 0.8rem;"> {{cvFileName}}
                                  </p>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                </div>
                <div class="card" id="section-card">
                <div class="card-header card-header-collapse" id="headingSix" data-toggle="collapse"
                  data-target="#collapseSix" aria-expanded="false" aria-controls="collapseSix">
                  <div class="row">
                    <div class="col-9">
                      <p class="text-left">Briefcases</p>
                    </div>
                    <div class="col-3 text-right">
                      <i class="fa fa-angle-down" style="font-size:1.5rem;color:#2888C7"></i>
                    </div>
                  </div>
                </div>
                <div id="collapseSix" class="collapse" aria-labelledby="headingSix" data-parent="#accordionExample">
                  <div class="card-body pt-0">
                    <div class="row">
                      <div class="col-12 py-5">
                        <app-briefcase-edit></app-briefcase-edit>
                      </div>
                    </div>
                  </div>
                </div>
                </div>
                <div class="card" id="section-card">
                <div class="card-header card-header-collapse" id="headingSeven" data-toggle="collapse"
                  data-target="#collapseSeven" aria-expanded="false" aria-controls="collapseSeven">
                  <div class="row">
                    <div class="col-9">
                      <p class="text-left">Resume</p>
                    </div>
                    <div class="col-3 text-right">
                      <i class="fa fa-angle-down" style="font-size:1.5rem;color:#2888C7"></i>
                    </div>
                  </div>
                </div>
                <div id="collapseSeven" class="collapse" aria-labelledby="headingSeven" data-parent="#accordionExample">
                  <div class="card-body pt-0">
                    <div class="row">
                      <div class="col-12 py-5">
                        <div class="form-group mx-auto">
                          <textarea class="form-control" id="commentsInputText" style="height: 10rem;"
                            formControlName="comments"
                            placeholder="Enter some comments about your skills and previous jobs to enrich your profile..."></textarea>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                </div>
              </ng-template>
            </div>
          </div>
          <div class="card text-right">
            <div class="card-footer accordion-footer rounded-0">
              <button type="button" class="col-2 btn btn-edit rounded-0 align-items-center align-text-top"
                style="background-color: #2888C7; color: white; font-size: 1.25rem;"
                data-toggle="tooltip" title="Edit" (click)="saveProfile()">
                <i class="far fa-save mr-2 text-left font-weight-light align-self-center" style="font-size: 1.25rem;"></i>
                Save
              </button>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

<div class="modal fade rounded-0" id="closeModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered rounded-0" role="document">
    <div class="modal-content rounded-0 border-0">
      <div class="modal-header rounded-0" style="background-color: #2888C7; color: white;">
        <!-- <h5 class="modal-title" id="exampleModalCenterTitle">Close Confirmation</h5> -->
        <label>Close Confirmation</label>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body rounded-0">
        Are you sure you want to cancel your profile edition?
      </div>
      <div class="modal-footer rounded-0">
        <button type="button" class="btn btn-previous rounded-0" data-dismiss="modal" style="background-color: #BFBDBE;">Decline</button>
        <button type="button" class="btn btn-send rounded-0" data-dismiss="modal"
          style="background-color: #2888C7;color: white;" (click)="onClose()">Accept</button>
      </div>
    </div>
  </div>
</div>
